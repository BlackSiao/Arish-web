import{_ as t,c as s,d as a,o as i}from"./app-UDSOE8tV.js";const n={};function d(r,e){return i(),s("div",null,[...e[0]||(e[0]=[a(`<h2 id="_1-ps-命令中的-color-输出解释" tabindex="-1"><a class="header-anchor" href="#_1-ps-命令中的-color-输出解释"><span>1. ps 命令中的 color 输出解释</span></a></h2><p>在使用 <code>ps aux | grep</code> 命令时，可能会看到类似以下输出：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>root      100815  0.0  0.0  19192  7012 ?        S    09:15   0:01 /usr/local/sbin/snmpd -p /var/net-snmp/snmpd.pid</span></span>
<span class="line"><span>root      473487  0.0  0.0   6380  2240 pts/2    S+   10:15   0:00 grep --color=auto snmpd</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>解释</strong>：<code>grep --color=auto</code> 是 <code>grep</code> 命令的默认选项，用于高亮显示匹配到的内容（如 &quot;snmpd&quot;），以便于查看。这与进程过滤无关，仅是 <code>grep</code> 的显示效果。</li><li><strong>无关性</strong>：它不会影响 <code>ps</code> 的实际输出，仅是 <code>grep</code> 的语法特性。</li></ul><h2 id="_2-ps-aux-命令输出解析" tabindex="-1"><a class="header-anchor" href="#_2-ps-aux-命令输出解析"><span>2. ps aux 命令输出解析</span></a></h2><p><code>ps aux</code> 显示进程的详细信息。示例输出：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>root  86967  0.0  0.0  19184 7000 ?    S Oct10  1:09  /usr/local/sbin/snmpd -p /var/net-snmp/snmpd.pid</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>各字段含义（从左到右）：</p><table><thead><tr><th>字段</th><th>含义</th></tr></thead><tbody><tr><td>root</td><td>用户名</td></tr><tr><td>86967</td><td>PID（进程 ID）</td></tr><tr><td>0.0</td><td>CPU 百分比占用</td></tr><tr><td>0.0</td><td>内存百分比占用</td></tr><tr><td>19184</td><td>VSZ（虚拟内存大小，约 19 MB）</td></tr><tr><td>7000</td><td>RSS（实际内存大小，约 7 MB）</td></tr><tr><td>?</td><td>TTY（终端，无关联终端）</td></tr><tr><td>S</td><td>进程状态（S 表示后台睡眠）</td></tr><tr><td>Oct10</td><td>启动时间</td></tr><tr><td>1:09</td><td>CPU 占用总时间</td></tr><tr><td>/usr/local/sbin/snmpd ...</td><td>启动命令</td></tr></tbody></table><h3 id="_2-1-为啥有些进程的command会显示一堆" tabindex="-1"><a class="header-anchor" href="#_2-1-为啥有些进程的command会显示一堆"><span>2.1 为啥有些进程的command会显示一堆？</span></a></h3><p>有些情况下，command词条会显示该进程的可执行文件路径、对应的配置路径，而有些进程对应的词条则是空无一物。这个原因在于进程的启动方式不同(这一点我还不是很能理解),可以在/proc/&lt;进程号&gt;/cmdline|cmm文件里面看到进程对应的command词条。而有一些进程没有这两个文件，自然就啥都没有。</p><h2 id="_3-ps-ef-命令-查看父进程-ppid" tabindex="-1"><a class="header-anchor" href="#_3-ps-ef-命令-查看父进程-ppid"><span>3. ps -ef 命令：查看父进程 (PPID)</span></a></h2><ul><li><strong>用途</strong>：显示进程的完整信息，包括父进程 ID (PPID)，适用于追踪进程树。</li><li><strong>参数解释</strong>： <ul><li><code>e</code>：显示所有进程（everything）。</li><li><code>f</code>：全格式（full format）。</li></ul></li></ul><p>示例输出：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>UID          PID    PPID  C STIME TTY          TIME CMD</span></span>
<span class="line"><span>root           1       0  7 21:41 ?        00:00:00 /sbin/init</span></span>
<span class="line"><span>root           2       1  0 21:41 ?        00:00:00 /init</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>字段</th><th>含义</th></tr></thead><tbody><tr><td>UID</td><td>用户 ID</td></tr><tr><td>PID</td><td>进程 ID</td></tr><tr><td>PPID</td><td>父进程 ID</td></tr><tr><td>C</td><td>CPU 使用率</td></tr><tr><td>STIME</td><td>启动时间</td></tr><tr><td>TTY</td><td>终端</td></tr><tr><td>TIME</td><td>CPU 时间</td></tr><tr><td>CMD</td><td>命令</td></tr></tbody></table><h2 id="_4-进程、fork-与父子进程关系" tabindex="-1"><a class="header-anchor" href="#_4-进程、fork-与父子进程关系"><span>4. 进程、fork() 与父子进程关系</span></a></h2><h3 id="_4-1-基本概念" tabindex="-1"><a class="header-anchor" href="#_4-1-基本概念"><span>4.1 基本概念</span></a></h3><ul><li><strong>进程</strong>：这里将“程序”与“进程”等同，指系统中运行的实体（如 <code>ps aux</code> 中显示的 PID 对应项）。</li><li><strong>fork()</strong>：系统调用，用于创建子进程。子进程是父进程的复制品。</li><li><strong>进程起源</strong>：Linux 中所有进程源于 init/systemd (PID=1)，通过反复 <code>fork()</code> 演变。</li></ul><h3 id="_4-2-父子进程定义" tabindex="-1"><a class="header-anchor" href="#_4-2-父子进程定义"><span>4.2 父子进程定义</span></a></h3><ul><li><strong>父进程</strong>：使用 <code>fork()</code> 创建其他进程的进程。</li><li><strong>子进程</strong>：被父进程 <code>fork()</code> 出的进程，受父进程控制。</li><li><strong>资源回收</strong>：父进程终止时，会回收所有子进程的系统资源。</li></ul><h3 id="_4-3-在-linux-中查看父子进程关系" tabindex="-1"><a class="header-anchor" href="#_4-3-在-linux-中查看父子进程关系"><span>4.3 在 Linux 中查看父子进程关系</span></a></h3><p>使用 <code>pstree -p</code> 命令查看进程树（带 PID）。</p><p>示例（nginx 进程）：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>[root@localhost sbin]# pstree -p | grep nginx</span></span>
<span class="line"><span>           |-nginx(22605)-+-nginx(27796)</span></span>
<span class="line"><span>           |              \`-nginx(27797)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>解释</strong>：PID 22605 是父进程，fork 出了子进程 27796 和 27797。</li></ul><p>结合 <code>ps aux | grep nginx</code> 确认：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>root       22605  0.0  0.0   8756  5732 ?        Ss   Oct14   0:00 nginx: master process /usr/local/appsys/normal/package/nginx/sbin/nginx</span></span>
<span class="line"><span>appuser    27796  0.0  0.0   9580  6848 ?        S    Oct14   0:00 nginx: worker process</span></span>
<span class="line"><span>appuser    27797  0.0  0.0  10604  6848 ?        S    Oct14   0:00 nginx: worker process</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>父进程</strong>：master process (PID 22605)，负责管理。</li><li><strong>子进程</strong>：worker processes，负责处理请求。</li></ul><h3 id="_4-4-为什么父子进程名称相同" tabindex="-1"><a class="header-anchor" href="#_4-4-为什么父子进程名称相同"><span>4.4 为什么父子进程名称相同？</span></a></h3><p>以 nginx 为例：</p><ol><li>启动主进程（Master）：加载配置、管理子进程。</li><li>Master 通过 <code>fork()</code> 创建多个 Worker 子进程：处理客户端请求。</li></ol><p>所有进程源于同一可执行文件 <code>/usr/sbin/nginx</code>，故名称相同，但功能不同。</p><h3 id="_4-5-僵尸进程-defunct" tabindex="-1"><a class="header-anchor" href="#_4-5-僵尸进程-defunct"><span>4.5 僵尸进程 (defunct)</span></a></h3><ul><li><strong>定义</strong>：子进程执行完毕（exit、错误或信号终止）后，其进程控制块仍保留在进程表中，处于“终止状态”。已回收 PID，但占用资源。</li><li><strong>正常回收</strong>：父进程通过 <code>wait()</code> 系统调用回收子进程。</li></ul><h4 id="查看僵尸进程" tabindex="-1"><a class="header-anchor" href="#查看僵尸进程"><span>查看僵尸进程</span></a></h4><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>[root@localhost sbin]# ps aux | grep defunct</span></span>
<span class="line"><span>admin    1568740  0.0  0.0      0     0 pts/0    Z    Oct15   0:00 [clish] &lt;defunct&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>状态 Z</strong>：表示僵尸进程。</li></ul><h4 id="回收僵尸进程" tabindex="-1"><a class="header-anchor" href="#回收僵尸进程"><span>回收僵尸进程</span></a></h4><ol><li><strong>首选</strong>：向父进程发送 <code>SIGCHLD</code> 信号（<code>kill -SIGCHLD &lt;父PID&gt;</code>），促使父进程调用 <code>wait()</code>。</li><li><strong>备选</strong>：如果父进程拒绝，终止父进程（<code>kill &lt;父PID&gt;</code>），让 init (PID=1) 收养并回收僵尸进程。</li></ol><h2 id="_5-ss-lntp-查看进程监听端口" tabindex="-1"><a class="header-anchor" href="#_5-ss-lntp-查看进程监听端口"><span>5. ss -lntp：查看进程监听端口</span></a></h2><ul><li><strong>用途</strong>：显示监听端口及其占用进程，便于排查端口冲突。</li></ul><h3 id="_5-1-参数说明" tabindex="-1"><a class="header-anchor" href="#_5-1-参数说明"><span>5.1 参数说明</span></a></h3><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-l</td><td>只显示监听 (LISTEN) 端口</td></tr><tr><td>-n</td><td>不解析域名/IP，直接显示数字</td></tr><tr><td>-t</td><td>只显示 TCP 连接</td></tr><tr><td>-p</td><td>显示占用端口的进程 (PID/程序名)</td></tr></tbody></table><h3 id="_5-2-输出示例" tabindex="-1"><a class="header-anchor" href="#_5-2-输出示例"><span>5.2 输出示例</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>LISTEN  0  128  0.0.0.0:80     0.0.0.0:*    users:((&quot;nginx&quot;,pid=1204,fd=6))</span></span>
<span class="line"><span>LISTEN  0  100  127.0.0.1:3306 0.0.0.0:*    users:((&quot;mysqld&quot;,pid=1563,fd=10))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><strong>解释</strong>：80 端口被 nginx (PID 1204) 占用；3306 端口被 mysqld (PID 1563) 占用。</li></ul><h3 id="_5-3-从监听地址判断访问范围" tabindex="-1"><a class="header-anchor" href="#_5-3-从监听地址判断访问范围"><span>5.3 从监听地址判断访问范围</span></a></h3><table><thead><tr><th>监听地址</th><th>说明</th></tr></thead><tbody><tr><td>127.0.0.1:3306</td><td>只允许本机访问</td></tr><tr><td>0.0.0.0:3306</td><td>允许外部（公网）访问</td></tr><tr><td>[::]:80</td><td>IPv6 全网段监听</td></tr><tr><td>192.168.0.0:80</td><td>允许特定网段访问</td></tr></tbody></table><hr><p><em>笔记创建时间：2025/10/14 09:15:12</em><br><em>Permalink：/notes/Linux/jy30bjng/</em></p>`,51)])])}const o=t(n,[["render",d]]),p=JSON.parse('{"path":"/notes/Linux/w7ph6v99/","title":"边边角角","lang":"zh-CN","frontmatter":{"title":"边边角角","createTime":"2025/10/14 09:15:12","permalink":"/notes/Linux/w7ph6v99/","description":"1. ps 命令中的 color 输出解释 在使用 ps aux | grep 命令时，可能会看到类似以下输出： 解释：grep --color=auto 是 grep 命令的默认选项，用于高亮显示匹配到的内容（如 \\"snmpd\\"），以便于查看。这与进程过滤无关，仅是 grep 的显示效果。 无关性：它不会影响 ps 的实际输出，仅是 grep 的语法...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"边边角角\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2026-02-10T08:07:34.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://blackhsiao.com/notes/Linux/w7ph6v99/"}],["meta",{"property":"og:site_name","content":"Black Hsiao 的技术笔记"}],["meta",{"property":"og:title","content":"边边角角"}],["meta",{"property":"og:description","content":"1. ps 命令中的 color 输出解释 在使用 ps aux | grep 命令时，可能会看到类似以下输出： 解释：grep --color=auto 是 grep 命令的默认选项，用于高亮显示匹配到的内容（如 \\"snmpd\\"），以便于查看。这与进程过滤无关，仅是 grep 的显示效果。 无关性：它不会影响 ps 的实际输出，仅是 grep 的语法..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2026-02-10T08:07:34.000Z"}],["meta",{"property":"article:modified_time","content":"2026-02-10T08:07:34.000Z"}]]},"readingTime":{"minutes":4.24,"words":1271},"git":{"createdTime":1770710854000,"updatedTime":1770710854000,"contributors":[{"name":"BlackSiao","username":"BlackSiao","email":"1546600539@qq.com","commits":1,"avatar":"https://avatars.githubusercontent.com/BlackSiao?v=4","url":"https://github.com/BlackSiao"}]},"autoDesc":true,"filePathRelative":"notes/Linux/常见疑问.md","headers":[]}');export{o as comp,p as data};
