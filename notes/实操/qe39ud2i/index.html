<!doctype html><html lang="zh-CN"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="generator" content="VuePress 2.0.0-rc.24" /><meta name="theme" content="VuePress Theme Plume 1.0.0-rc.164" /><script id="check-mac-os">document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))</script><script id="check-dark-mode">;(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();</script><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"系统资源监控","image":[""],"dateModified":"2026-02-10T08:07:34.000Z","author":[]}</script><meta property="og:url" content="https://blackhsiao.com/notes/%E5%AE%9E%E6%93%8D/qe39ud2i/"><meta property="og:site_name" content="Black Hsiao 的技术笔记"><meta property="og:title" content="系统资源监控"><meta property="og:description" content="1. free -h(human) —— 查看当前内存使用情况 该命令基本都是查看当前的内存情况，能很直观的看到现在是否存在OOM的情况，但无法定位出原因。 关键字段解释 核心结论：看内存够不够，只看 available，不要看 free！ 【补充说明】Swap 被使用不一定是坏事，有时候跑大业务的时候内存被打满是很正常的，但如果 si/so（后面 v..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2026-02-10T08:07:34.000Z"><meta property="article:modified_time" content="2026-02-10T08:07:34.000Z"><link rel="icon" type="image/png" href="https://theme-plume.vuejs.press/favicon-32x32.png"><meta name="google" content="notranslate"><script>
      if (window.location.pathname === '/' && !localStorage.getItem('vuepress-lang-preference')) {
        localStorage.setItem('vuepress-lang-preference', 'zh-CN');
      }
    </script><title>系统资源监控 | Black Hsiao 的技术笔记</title><meta name="description" content="1. free -h(human) —— 查看当前内存使用情况 该命令基本都是查看当前的内存情况，能很直观的看到现在是否存在OOM的情况，但无法定位出原因。 关键字段解释 核心结论：看内存够不够，只看 available，不要看 free！ 【补充说明】Swap 被使用不一定是坏事，有时候跑大业务的时候内存被打满是很正常的，但如果 si/so（后面 v..."><link rel="preload" href="/assets/style-COt8Kyae.css" as="style"><link rel="stylesheet" href="/assets/style-COt8Kyae.css"><link rel="modulepreload" href="/assets/app-UDSOE8tV.js"><link rel="modulepreload" href="/assets/index.html-r6Yidp45.js"></head><body><div id="app"><!--[--><!--[--><div class="theme-plume vp-layout" vp-container data-v-f73ca3da><!--[--><!--[--><!--]--><!--[--><span tabindex="-1" data-v-17e3d305></span><a href="#VPContent" class="vp-skip-link visually-hidden" data-v-17e3d305> Skip to content </a><!--]--><!----><header class="vp-nav" data-v-f73ca3da data-v-e98a6132><div class="vp-navbar" vp-navbar data-v-e98a6132 data-v-2c31ea5e><div class="wrapper" data-v-2c31ea5e><div class="container" data-v-2c31ea5e><div class="title" data-v-2c31ea5e><div class="vp-navbar-title has-sidebar" data-v-2c31ea5e data-v-1a4f50af><a class="vp-link link no-icon title" href="/" data-v-1a4f50af><!--[--><!--[--><!--]--><!--[--><!--[--><!--[--><img class="vp-image dark logo" style="" src="https://theme-plume.vuejs.press/plume.png" alt data-v-480e858a><!--]--><!--[--><img class="vp-image light logo" style="" src="https://theme-plume.vuejs.press/plume.png" alt data-v-480e858a><!--]--><!--]--><!--]--><span data-v-1a4f50af>Black Hsiao 的技术笔记</span><!--[--><!--]--><!--]--><!----></a></div></div><div class="content" data-v-2c31ea5e><div class="content-body" data-v-2c31ea5e><!--[--><!--]--><div class="vp-navbar-search search" data-v-2c31ea5e><div class="search-wrapper" data-v-97535d1e><!----><div id="local-search" data-v-97535d1e><button type="button" class="mini-search mini-search-button" aria-label="搜索文档" data-v-97535d1e><span class="mini-search-button-container"><span class="mini-search-search-icon vpi-mini-search" aria-label="search icon"></span><span class="mini-search-button-placeholder">搜索文档</span></span><span class="mini-search-button-keys"><kbd class="mini-search-button-key"></kbd><kbd class="mini-search-button-key">K</kbd></span></button></div></div></div><!--[--><!--]--><nav aria-labelledby="main-nav-aria-label" class="vp-navbar-menu menu" data-v-2c31ea5e data-v-d43c1732><span id="main-nav-aria-label" class="visually-hidden" data-v-d43c1732>Main Navigation</span><!--[--><!--[--><a class="vp-link link navbar-menu-link" href="/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><!----><span data-v-d4acf911>首页</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><!----><span data-v-d4acf911>博客</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/tags/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><!----><span data-v-d4acf911>标签</span><!----><!--]--><!----></a><!--]--><!--[--><a class="vp-link link navbar-menu-link" href="/blog/archives/" tabindex="0" data-v-d43c1732 data-v-d4acf911><!--[--><!----><span data-v-d4acf911>归档</span><!----><!--]--><!----></a><!--]--><!--[--><div class="vp-flyout vp-navbar-menu-group" data-v-d43c1732 data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-86530b6c><span class="text" data-v-86530b6c><!----><!----><span data-v-86530b6c>笔记</span><!----><span class="vpi-chevron-down text-icon" data-v-86530b6c></span></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><div class="items" data-v-709dc2b1><!--[--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/notes/Internet/" data-v-1ff1855f><!--[--><!----> Internet <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/notes/Linux/" data-v-1ff1855f><!--[--><!----> Linux <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/notes/%E5%AE%9E%E6%93%8D/8tjui8dt/" data-v-1ff1855f><!--[--><!----> 实操 <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/notes/%E4%B8%AD%E9%97%B4%E4%BB%B6/" data-v-1ff1855f><!--[--><!----> 中间件 <!----><!--]--><!----></a></div><!--]--><!--[--><div class="vp-menu-link" data-v-709dc2b1 data-v-1ff1855f><a class="vp-link link" href="/notes/硬件相关内容/" data-v-1ff1855f><!--[--><!----> 硬件相关内容 <!----><!--]--><!----></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!--[--><!--]--><!----><div class="vp-navbar-appearance appearance" data-v-2c31ea5e data-v-a295abf6><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-a295abf6 data-v-596c25a9 data-v-7eb32327><span class="check" data-v-7eb32327><span class="icon" data-v-7eb32327><!--[--><span class="vpi-sun sun" data-v-596c25a9></span><span class="vpi-moon moon" data-v-596c25a9></span><!--]--></span></span></button></div><div class="vp-social-links vp-navbar-social-links social-links" data-v-2c31ea5e data-v-ad52545c data-v-40bac536><!--[--><a class="vp-social-link no-icon" href="/" aria-label="github" target="_blank" rel="noopener" data-v-40bac536 data-v-67b21932><span class="vpi-social-github" /></a><!--]--></div><div class="vp-flyout vp-navbar-extra extra" data-v-2c31ea5e data-v-652282fd data-v-86530b6c><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-86530b6c><span class="vpi-more-horizontal icon" data-v-86530b6c></span></button><div class="menu" data-v-86530b6c><div class="vp-menu" data-v-86530b6c data-v-709dc2b1><!----><!--[--><!--[--><!----><div class="group" data-v-652282fd><div class="item appearance" data-v-652282fd><p class="label" data-v-652282fd>外观</p><div class="appearance-action" data-v-652282fd><button class="vp-switch vp-switch-appearance" type="button" role="switch" title aria-checked="false" data-v-652282fd data-v-596c25a9 data-v-7eb32327><span class="check" data-v-7eb32327><span class="icon" data-v-7eb32327><!--[--><span class="vpi-sun sun" data-v-596c25a9></span><span class="vpi-moon moon" data-v-596c25a9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-652282fd><div class="item social-links" data-v-652282fd><div class="vp-social-links social-links-list" data-v-652282fd data-v-40bac536><!--[--><a class="vp-social-link no-icon" href="/" aria-label="github" target="_blank" rel="noopener" data-v-40bac536 data-v-67b21932><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="vp-navbar-hamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="nav-screen" data-v-2c31ea5e data-v-2b50024d><span class="container" data-v-2b50024d><span class="top" data-v-2b50024d></span><span class="middle" data-v-2b50024d></span><span class="bottom" data-v-2b50024d></span></span></button></div></div></div></div><div class="divider" data-v-2c31ea5e><div class="divider-line" data-v-2c31ea5e></div></div></div><!----></header><div class="vp-local-nav reached-top" data-v-f73ca3da data-v-3944d8e8><button class="menu" aria-expanded="false" aria-controls="SidebarNav" data-v-3944d8e8><span class="vpi-align-left menu-icon" data-v-3944d8e8></span><span class="menu-text" data-v-3944d8e8>Menu</span></button><div class="vp-local-nav-outline-dropdown" style="--vp-vh:0px;" data-v-3944d8e8 data-v-4114a62c><button data-v-4114a62c>返回顶部</button><!----></div></div><aside class="vp-sidebar" vp-sidebar data-v-f73ca3da data-v-95211354><div class="curtain" data-v-95211354></div><nav id="SidebarNav" class="nav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-95211354><span id="sidebar-aria-label" class="visually-hidden" data-v-95211354> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-473fd05b><section class="vp-sidebar-item sidebar-item level-0 has-active" data-v-473fd05b data-v-12048f0f><!----><div data-v-12048f0f data-v-12048f0f><div class="items" data-v-12048f0f><!--[--><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/notes/%E5%AE%9E%E6%93%8D/r6b4zcrn/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>CA证书</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/notes/%E5%AE%9E%E6%93%8D/l09d0g8o/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>DNS劫持</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/notes/%E5%AE%9E%E6%93%8D/f1n4r56w/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Linux的挂载</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/notes/Linux/speghfnc/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>文件系统和扩容</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/notes/%E5%AE%9E%E6%93%8D/qe39ud2i/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>系统资源监控</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/notes/%E5%AE%9E%E6%93%8D/d6217rzf/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>PostgreSQL-技术支持必备知识</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/notes/%E5%AE%9E%E6%93%8D/8tjui8dt/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>Readme</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/notes/%E5%AE%9E%E6%93%8D/ruknabco/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>ls的妙用</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/notes/%E5%AE%9E%E6%93%8D/35dlymr1/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>ssh_tunnel</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/notes/%E5%AE%9E%E6%93%8D/ee2h6oqp/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>黑话</span><!----></p><!--]--><!----></a><!----></div><!----></div><div class="vp-sidebar-item sidebar-item level-1 is-link" data-v-12048f0f data-v-12048f0f><div class="item" data-v-12048f0f><div class="indicator" data-v-12048f0f></div><!----><a class="vp-link link link" href="/notes/%E5%AE%9E%E6%93%8D/jiw17wls/" data-v-12048f0f><!--[--><p class="text" data-v-12048f0f><span data-v-12048f0f>华三交换机</span><!----></p><!--]--><!----></a><!----></div><!----></div><!--]--></div></div></section></div><!--]--><!--[--><!--]--></nav></aside><!--[--><div id="VPContent" vp-content class="vp-content has-sidebar" data-v-f73ca3da data-v-b2beaca7><div class="vp-doc-container has-sidebar has-aside" data-v-b2beaca7 data-v-23f6ad98><!--[--><!--]--><div class="container" data-v-23f6ad98><div class="aside" vp-outline data-v-23f6ad98><div class="aside-curtain" data-v-23f6ad98></div><div class="aside-container" data-v-23f6ad98><div class="aside-content" data-v-23f6ad98><div class="vp-doc-aside" data-v-23f6ad98 data-v-5976474c><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="vp-doc-aside-outline" role="navigation" data-v-5976474c data-v-aa56eba0><div class="content" data-v-aa56eba0><div class="outline-marker" data-v-aa56eba0></div><div id="doc-outline-aria-label" aria-level="2" class="outline-title" role="heading" data-v-aa56eba0><span data-v-aa56eba0>此页内容</span><span class="vpi-print icon" data-v-aa56eba0></span></div><ul class="root" data-v-aa56eba0 data-v-3e6b023c><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-5976474c></div><!--[--><!--]--></div></div></div></div><div class="content" data-v-23f6ad98><div class="content-container" data-v-23f6ad98><!--[--><!--]--><main class="main" data-v-23f6ad98><nav class="vp-breadcrumb" data-v-23f6ad98 data-v-1ae4ad7a><ol vocab="https://schema.org/" typeof="BreadcrumbList" data-v-1ae4ad7a><!--[--><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link link breadcrumb" href="/" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->首页<!--]--><!----></a><span class="vpi-chevron-right" data-v-1ae4ad7a></span><meta property="name" content="首页" data-v-1ae4ad7a><meta property="position" content="1" data-v-1ae4ad7a></li><li property="itemListElement" typeof="ListItem" data-v-1ae4ad7a><a class="vp-link link breadcrumb current" href="/notes/%E5%AE%9E%E6%93%8D/qe39ud2i/" property="item" typeof="WebPage" data-v-1ae4ad7a><!--[-->系统资源监控<!--]--><!----></a><!----><meta property="name" content="系统资源监控" data-v-1ae4ad7a><meta property="position" content="2" data-v-1ae4ad7a></li><!--]--></ol></nav><!--[--><!--]--><!--[--><h1 class="vp-doc-title page-title" data-v-ba8d1a1e><!----> 系统资源监控 <!----></h1><div class="vp-doc-meta" data-v-ba8d1a1e><!--[--><!--]--><p class="reading-time" data-v-ba8d1a1e><span class="vpi-books icon" data-v-ba8d1a1e></span><span data-v-ba8d1a1e>约 1671 字</span><span data-v-ba8d1a1e>大约 6 分钟</span></p><!----><!--[--><!--]--><p class="create-time" data-v-ba8d1a1e><span class="vpi-clock icon" data-v-ba8d1a1e></span><span data-v-ba8d1a1e>2025-12-16</span></p></div><!--]--><!--[--><!--]--><div class="_notes_%E5%AE%9E%E6%93%8D_qe39ud2i_ external-link-icon-enabled vp-doc plume-content" vp-content data-v-23f6ad98><!--[--><!--]--><div data-v-23f6ad98><h2 id="_1-free-h-human-——-查看当前内存使用情况" tabindex="-1"><a class="header-anchor" href="#_1-free-h-human-——-查看当前内存使用情况"><span>1. free -h(human) —— 查看当前内存使用情况</span></a></h2><p>该命令基本都是查看当前的内存情况，能很直观的看到现在是否存在OOM的情况，但无法定位出原因。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">$</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> free</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -h</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">              total</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        used</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        free</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">      shared</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  buff/cache</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">   available</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Mem:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">           820Mi</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">       183Mi</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">        82Mi</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">       0.0Ki</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">       555Mi</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">       502Mi</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">Swap:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">            0B</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">          0B</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">          0B</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="关键字段解释" tabindex="-1"><a class="header-anchor" href="#关键字段解释"><span>关键字段解释</span></a></h3><table><thead><tr><th>字段</th><th>含义说明</th></tr></thead><tbody><tr><td><strong>available</strong></td><td>最重要！表示系统当前<strong>真正还能分配给新进程的内存</strong> = 空闲内存 + 可回收的 cache/buffer</td></tr><tr><td><strong>used</strong></td><td>已分配出去的内存(包含正在使用的 + 已经被缓存占用的)</td></tr><tr><td><strong>buff/cache</strong></td><td>Linux 主动用来缓存文件/块设备的内存，高是正常现象（“空闲内存就是浪费”）</td></tr><tr><td><strong>free</strong></td><td>完全没被碰过的内存，日常可以忽略，值很小很正常</td></tr><tr><td><strong>Swap</strong></td><td>硬盘划出来当“临时内存”用。当物理内存彻底不够且无法立刻回收时，才会使用</td></tr></tbody></table><blockquote><p><strong>核心结论</strong>：看内存够不够，只看 <code>available</code>，不要看 <code>free</code>！</p></blockquote><p>【补充说明】Swap 被使用不一定是坏事，有时候跑大业务的时候内存被打满是很正常的，但如果 <code>si/so</code>（后面 vmstat 会讲）长期非 0，说明内存压力已经很大，需要扩容或优化。</p><h2 id="_2-vmstat-——-快速判断系统哪类资源是瓶颈" tabindex="-1"><a class="header-anchor" href="#_2-vmstat-——-快速判断系统哪类资源是瓶颈"><span>2. vmstat —— 快速判断系统哪类资源是瓶颈</span></a></h2><p>vmstat更多的是从CPU的角度出发，看看现在等待使用CPU的进程有多少，CPU是否空闲，CPU等待I/O的时间长不长</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># 每秒刷新一次</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">vmstat</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-text"><span class="line"><span>procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span></span>
<span class="line"><span> r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st</span></span>
<span class="line"><span> 4  0      0  84984   1004 568064    0    0     1     6   29   28  1  2 97  0  0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="重要字段快速判断法则" tabindex="-1"><a class="header-anchor" href="#重要字段快速判断法则"><span>重要字段快速判断法则</span></a></h3><p><em>扩展</em>: 可以通过 <code>lscpu</code> 命令查看服务器有几核</p><table><thead><tr><th>字段</th><th>含义</th><th>经验阈值判断</th></tr></thead><tbody><tr><td>r</td><td>就绪队列（等待 CPU 的进程数）</td><td>r ≈ CPU 核数：正常<br>r &gt; CPU 核数 × 2：CPU 瓶颈</td></tr><tr><td>b</td><td>被阻塞的进程（通常在等 I/O）</td><td>b 持续大于 0：可能有 I/O 瓶颈</td></tr><tr><td>si/so</td><td>Swap In / Swap Out</td><td>持续非 0：内存严重不足，已经开始换出到硬盘</td></tr><tr><td>bi/bo</td><td>块设备读/写（KB/s）</td><td>持续很高 + wa 很高：磁盘 I/O 瓶颈</td></tr><tr><td>us</td><td>用户态 CPU</td><td></td></tr><tr><td>sy</td><td>内核态 CPU</td><td></td></tr><tr><td>id</td><td>空闲 CPU</td><td></td></tr><tr><td>wa(wait i/o)</td><td>CPU空闲，等待I/O的时间</td><td>wa高[&gt;30%]，就说明CPU在等待IO，罪魁祸首是磁盘读的太慢了</td></tr></tbody></table><h2 id="_3-dmesg-——-内核环形缓冲区日志-底层第一现场" tabindex="-1"><a class="header-anchor" href="#_3-dmesg-——-内核环形缓冲区日志-底层第一现场"><span>3. dmesg —— 内核环形缓冲区日志（底层第一现场）</span></a></h2><p>全称：<strong>display message</strong> 或 <strong>driver message</strong>，读作 “dee-message”</p><ul><li>记录的是内核态的错误、警告、信息</li><li>典型场景： <ul><li>OOM killer 杀了进程</li><li>硬盘 I/O 错误（smart、坏道）</li><li>网卡掉线、驱动异常</li><li>内核参数调优失败等</li></ul></li></ul><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">dmesg</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> tail</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -50</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">          # 看最新的 50 条</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">dmesg</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -w</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">                  # 实时跟随（类似 tail -f）</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">dmesg</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --level=err,warn</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # 只看错误和警告</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">dmesg</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -T</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> egrep</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -i</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">oom|kill|out of memory|blocked</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 通过内核的日志，给出IO过高的铁证</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-journalctl-——-systemd-系统与服务日志" tabindex="-1"><a class="header-anchor" href="#_4-journalctl-——-systemd-系统与服务日志"><span>4. journalctl —— systemd 系统与服务日志</span></a></h2><p>与 systemd 深度绑定，所有 <code>systemctl</code> 管理的服务日志都在这里。</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">journalctl</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -xe</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">            # -x 加人性化解释，-e 直接跳到最后</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">journalctl</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -f</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">             # 实时跟随（等价于 tail -f）</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">journalctl</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -u</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> sshd</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">        # 查看某个服务日志</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">journalctl</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --since</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">10 min ago</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="日志分类小结-别用错" tabindex="-1"><a class="header-anchor" href="#日志分类小结-别用错"><span>日志分类小结（别用错）</span></a></h3><table><thead><tr><th>场景</th><th>看哪里</th></tr></thead><tbody><tr><td>应用自己打印的日志</td><td>看应用自己的日志文件（如 /var/log/nginx/access.log）</td></tr><tr><td>systemd 服务日志</td><td>journalctl -u 服务名</td></tr><tr><td>内核级异常</td><td>dmesg 或 journalctl -k</td></tr><tr><td>所有系统+服务日志</td><td>journalctl</td></tr></tbody></table><h2 id="_5-iostat-x-——-详细查看磁盘-i-o-性能-判断-i-o-瓶颈神器" tabindex="-1"><a class="header-anchor" href="#_5-iostat-x-——-详细查看磁盘-i-o-性能-判断-i-o-瓶颈神器"><span>5. iostat -x —— 详细查看磁盘 I/O 性能（判断 I/O 瓶颈神器）</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">iostat</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -xz</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">              # 推荐参数组合，带扩展统计，每秒刷新</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>关键指标：</p><table><thead><tr><th>指标</th><th>含义</th><th>经验阈值（严重瓶颈）</th></tr></thead><tbody><tr><td>%util</td><td>磁盘忙碌百分比</td><td>&gt; 80% 基本就很危险了</td></tr><tr><td>await</td><td>平均 I/O 等待时间（ms）</td><td>&gt; 20-50ms 已经很慢</td></tr><tr><td>svctm</td><td>平均服务时间（越小越好，已弃用）</td><td></td></tr><tr><td>r/s + w/s</td><td>每秒读写 IOPS</td><td></td></tr><tr><td>rkB/s + wkB/s</td><td>每秒读写吞吐量</td><td></td></tr></tbody></table><p><strong>I/O 瓶颈典型表现</strong>：</p><ul><li><code>wa</code>（vmstat）很高</li><li><code>%util</code> 接近 100%</li><li><code>await</code> 很高</li><li>大量进程在 <code>D</code> 状态（uninterruptible sleep，通常是等磁盘）</li></ul><h3 id="经典-i-o-流程图-为什么-cpu-会-发呆" tabindex="-1"><a class="header-anchor" href="#经典-i-o-流程图-为什么-cpu-会-发呆"><span>经典 I/O 流程图（为什么 CPU 会“发呆”）</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-"><span class="line"><span>进程发起读请求</span></span>
<span class="line"><span>      ↓</span></span>
<span class="line"><span>内核向磁盘发 I/O 请求</span></span>
<span class="line"><span>      ↓</span></span>
<span class="line"><span>磁盘硬件慢慢读取（机械硬盘几十~几百毫秒，SSD 几十微秒）</span></span>
<span class="line"><span>      ↓</span></span>
<span class="line"><span>整个进程进入 D 状态（不可中断睡眠），CPU 啥也干不了，只能等</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-sar-命令学习笔记" tabindex="-1"><a class="header-anchor" href="#_6-sar-命令学习笔记"><span>6.sar 命令学习笔记</span></a></h2><p><code>sar</code>（System Activity Reporter）是 Linux 系统中用于<strong>收集和查看系统性能数据</strong>的工具，属于 <code>sysstat</code> 工具包。可以查看 CPU、内存、磁盘、网络等资源的使用情况，并支持历史数据分析。</p><hr><h3 id="_1-常用功能" tabindex="-1"><a class="header-anchor" href="#_1-常用功能"><span>1. 常用功能</span></a></h3><ul><li>查看 CPU 使用率</li><li>查看内存使用情况</li><li>查看磁盘 I/O</li><li>查看网络流量</li><li>查看系统负载、上下文切换、进程创建等</li><li>查看历史性能数据（依赖 sysstat 服务）</li></ul><hr><h3 id="_2-常用命令示例" tabindex="-1"><a class="header-anchor" href="#_2-常用命令示例"><span>2. 常用命令示例</span></a></h3><h3 id="查看-cpu-使用情况" tabindex="-1"><a class="header-anchor" href="#查看-cpu-使用情况"><span>查看 CPU 使用情况</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sar</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -u</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sar</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -u</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 5</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 每 1 秒采样一次，共 5 次</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sar</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -r</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">      # 查看内存使用情况</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sar</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -d</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">      # 查看磁盘 I/O</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sar</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -n</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> DEV</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 查看网络流量</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sar</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -u</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -f</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /var/log/sa/sa15</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 查看 15 号的 CPU 使用情况</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="sar-命令-cpu-字段全称与含义解释" tabindex="-1"><a class="header-anchor" href="#sar-命令-cpu-字段全称与含义解释"><span>sar 命令 CPU 字段全称与含义解释</span></a></h3><table><thead><tr><th>字段</th><th>全称/含义</th><th>解释</th></tr></thead><tbody><tr><td><strong>%user</strong></td><td><strong>User time</strong></td><td>CPU 用于运行<strong>用户态进程</strong>（普通应用、程序）的百分比。通常是主要消耗。</td></tr><tr><td><strong>%nice</strong></td><td><strong>Nice time</strong></td><td>CPU 用于运行<strong>低优先级（niced）用户态进程</strong>的百分比（nice 值 &gt;0 的进程，优先级降低，让出 CPU 给其他任务）。常见于后台批量任务。</td></tr><tr><td><strong>%system</strong></td><td><strong>System/Kernel time</strong></td><td>CPU 用于运行<strong>内核态任务</strong>（系统调用、驱动、中断等）的百分比。</td></tr><tr><td><strong>%iowait</strong></td><td><strong>I/O wait</strong></td><td>CPU <strong>等待 IO 操作完成</strong>的百分比（类似 vmstat 的 wa）。高时表示 IO 瓶颈（磁盘/网络慢，导致 CPU 空闲但等 IO）。</td></tr><tr><td><strong>%steal</strong></td><td><strong>Steal time</strong></td><td>在<strong>虚拟化环境</strong>（VM、云服务器）中，虚拟 CPU 被 hypervisor（虚拟机管理器）“偷走”去服务其他虚拟机或宿主机的百分比。物理机上为 0；云服务器（如阿里云、AWS）上如果高，说明宿主机超售或负载重。</td></tr><tr><td><strong>%idle</strong></td><td><strong>Idle time</strong></td><td>CPU <strong>完全空闲</strong>（无任务、无 IO 等待）的百分比。高表示系统很闲。</td></tr></tbody></table><h2 id="快速故障定位口诀-背下来超实用" tabindex="-1"><a class="header-anchor" href="#快速故障定位口诀-背下来超实用"><span>快速故障定位口诀（背下来超实用）</span></a></h2><ol><li>服务器卡了 → 先 <code>vmstat 1</code> 看 r / wa / si/so <ul><li>r 高 → CPU 瓶颈</li><li>wa 高 → 磁盘 I/O 瓶颈</li><li>si/so 非 0 → 内存不够</li></ul></li><li>有进程被杀 → <code>dmesg | grep -i kill</code> 或 <code>journalctl -k | grep -i kill</code></li><li>服务挂了 → <code>journalctl -u 服务名</code></li><li>磁盘慢 → <code>iostat -xz 1</code></li></ol></div><!----><!----><!----></div></main><footer class="vp-doc-footer" data-v-23f6ad98 data-v-7138e2cb><!--[--><!--]--><!----><div class="contributors" aria-label="Contributors" data-v-7138e2cb><span class="contributors-label" data-v-7138e2cb>贡献者: </span><span class="contributors-info" data-v-7138e2cb><!--[--><!--[--><span class="contributor" data-v-7138e2cb>BlackSiao</span><!----><!--]--><!--]--></span></div><nav class="prev-next" data-v-7138e2cb><div class="pager" data-v-7138e2cb><a class="vp-link link pager-link prev" href="/notes/Linux/speghfnc/" data-v-7138e2cb><!--[--><span class="desc" data-v-7138e2cb>上一页</span><span class="title" data-v-7138e2cb>文件系统和扩容</span><!--]--><!----></a></div><div class="pager" data-v-7138e2cb><a class="vp-link link pager-link next" href="/notes/%E5%AE%9E%E6%93%8D/d6217rzf/" data-v-7138e2cb><!--[--><span class="desc" data-v-7138e2cb>下一页</span><span class="title" data-v-7138e2cb>PostgreSQL-技术支持必备知识</span><!--]--><!----></a></div></nav></footer><!----><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!--]--><button style="display:none;" type="button" class="vp-back-to-top" aria-label="back to top" data-v-f73ca3da data-v-bcf8d9a6><span class="percent" data-allow-mismatch data-v-bcf8d9a6>0%</span><span class="show icon vpi-back-to-top" data-v-bcf8d9a6></span><svg aria-hidden="true" data-v-bcf8d9a6><circle cx="50%" cy="50%" data-allow-mismatch style="stroke-dasharray:calc(0% - 12.566370614359172px) calc(314.1592653589793% - 12.566370614359172px);" data-v-bcf8d9a6></circle></svg></button><svg style="display:none;" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="sign down" class="vp-sign-down" aria-hidden="true" data-v-f73ca3da data-v-900978de><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" data-v-900978de><path d="m19 11l-7 6l-7-6" data-v-900978de></path><path d="m19 5l-7 6l-7-6" opacity="0.6" data-v-900978de></path></g></svg><footer class="vp-footer has-sidebar" vp-footer data-v-f73ca3da data-v-400675cf><!--[--><div class="container" data-v-400675cf><p class="message" data-v-400675cf>Powered by <a target="_blank" href="https://v2.vuepress.vuejs.org/">VuePress</a> & <a target="_blank" href="https://theme-plume.vuejs.press">vuepress-theme-plume</a></p><!----></div><!--]--></footer><!--[--><!--]--><!--]--></div><!----><!--]--><!--[--><!--]--><!--]--></div><script type="module" src="/assets/app-UDSOE8tV.js" defer></script></body></html>