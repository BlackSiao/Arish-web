---
title: 华三交换机
createTime: 2025/09/27 07:12:48
permalink: /notes/实操/jiw17wls/
---
# 交换机配置与接口笔记

## 1. 了解交换机
### 命令：显示当前配置
```bash
display current-configuration
```
- 显示交换机的完整配置，包括所有设置和参数。

## 2. 查看所有接口情况
### 命令：显示接口简要信息
```bash
display interface brief
```
**示例输出：**
```
InUti/OutUti: input utility/output utility
Interface                   PHY   Protocol  InUti OutUti   inErrors  outErrors
GigabitEthernet0/0/1        up    up        0.08%  0.06%          0          0
GigabitEthernet0/0/2        up    up        0.01%     0%          0          0
Vlanif1                     down  down         --     --          0          0
Vlanif8                     up    up           --     --          0          0
Vlanif10                    up    up           --     --          0          0
```
```为啥物理接口这么长
Gigabit_Ethernet --> 千兆_网卡
0/0/1  --> 槽位号(slot)/子卡号(subcard)/端口号(port)
```


**PHY（物理层状态）**
- `up`：物理链路正常（电缆连接正常，端口启用）。
- `down`：物理链路未连接（可能是未插网线、端口被禁用或对端设备未开启）。
- 其他状态（如 `*down` 表示管理性关闭，`#down` 表示链路检测关闭等）。
  
**Protocol（协议层状态）**
- **内容**：显示接口的协议状态，通常与数据链路层相关，可能的值包括：
  - `up`：协议层正常，可以传输数据。
  - `down`：协议层不可用，可能是配置问题（如 VLAN 不匹配）或物理层问题。
  - `(s)`：表示接口处于伪装（spoofing）状态，通常用于 VLAN 接口，表示没有实际物理链路但逻辑上启用。
- 协议状态反映接口是否能够正常处理数据包。如果物理层 `up` 但协议层 `down`，可能是配置错误（如 VLAN 配置错误或端口未加入正确 VLAN）。

**InUti/OutUti（输入/输出利用率）**
- **内容**：显示接口的输入和输出流量占端口带宽的百分比。例如，GigabitEthernet0/0/1 的 InUti 是 0.08%，OutUti 是 0.06%。
- 关注利用率较高的接口（如接近或超过 50%），可能需要优化网络流量或升级带宽。
- 利用率为 0% 的接口（如 GigabitEthernet0/0/5）通常是未使用的端口，可能是正常的（未连接设备）。

**inErrors/outErrors（输入/输出错误）**
- **内容**：显示接口接收（inErrors）和发送（outErrors）的数据包错误数。例如，GigabitEthernet0/0/3 有 7 个输入错误，其他接口均为 0。

### 查看具体接口信息
```bash
display interface GigabitEthernet0/0/5
```

**Q：这里显示的每一个接口对应交换机的一个物理接口或者逻辑接口，这句话如何理解？**  
**A：**  
物理接口 (GigabitEthernet0/0/1) 通常连设备，比如说电脑、服务器、另一台交换机啥的。  
逻辑接口 (Vlanif)：用于 VLAN 的逻辑配置，可能与 IP 地址或网关相关。

【物理接口可以配置为不同模式（如 access 或 trunk），决定它们如何处理 VLAN 数据。

**Vlanif 的作用**：Vlanif 是一个逻辑接口，通常用于 VLAN 间的路由（例如，VLAN 8 和 VLAN 10 之间的通信需要通过 Vlanif8 和 Vlanif10 的 IP 地址）。它不直接对应物理端口，而是基于 VLAN 的配置。[听起来像是网关]

**数据转发路径**
- 假设 PC1 (VLAN10, IP 192.168.10.10) 要访问 PC2 (VLAN20, IP 192.168.20.20)：
- PC1 发现目标 IP 不在自己子网 → 发 ARP 请求问网关 (192.168.10.1)。
- ARP 得到 Vlanif10 的 MAC，PC1 把数据帧发给交换机。
- 交换机在 VLAN 10 收到帧后，发现目标 MAC 是自己（Vlanif10 的 MAC）→ 交给三层转发引擎。
- 三层转发引擎在 交换机内部 做一次路由查询：192.168.20.0/24 → 出口接口 Vlanif20。
- 再通过 Vlanif20 发出去，打上 VLAN 20 的 tag，转发到 PC2。

- 👉 注意：这个过程不需要“物理绕一圈”，流量就在交换机内部完成 从 Vlanif10 → Vlanif20 的逻辑转发。


## 3. 显示目前所有的 VLAN
### 命令：显示 VLAN
```bash
display vlan
```
**示例输出：**
```
The total number of VLANs is: 6
--------------------------------------------------------------------------------
U: Up;         D: Down;         TG: Tagged;         UT: Untagged;
MP: Vlan-mapping;               ST: Vlan-stacking;
#: ProtocolTransparent-vlan;    *: Management-vlan;
--------------------------------------------------------------------------------

VID  Type    Ports                                                          
--------------------------------------------------------------------------------
1    common  UT:GE0/0/8(D)      GE0/0/13(D)     GE0/0/25(D)     GE0/0/26(D)     
                GE0/0/27(D)     GE0/0/28(D)                                     
8    common  TG:GE0/0/3(U)      GE0/0/4(U)                                      
10   common  UT:GE0/0/9(D)      GE0/0/15(D)     GE0/0/16(D)                     
             TG:GE0/0/3(U)      GE0/0/4(U)                                      
20   common  UT:GE0/0/14(D)                                                     
             TG:GE0/0/3(U)      GE0/0/4(U)                                      
100  common  UT:GE0/0/10(D)     GE0/0/11(D)     GE0/0/12(D)                     
             TG:GE0/0/3(U)      GE0/0/4(U)      GE0/0/8(D)                      
200  common  UT:GE0/0/1(U)      GE0/0/2(U)      GE0/0/5(D)      GE0/0/6(D)      
                GE0/0/7(D)      GE0/0/21(D)     GE0/0/22(D)     GE0/0/23(D)     
                GE0/0/24(U)                                                      

VID  Status  Property      MAC-LRN Statistics Description      
--------------------------------------------------------------------------------
1    enable  default       enable  disable    VLAN 0001                         
8    enable  default       enable  disable    VLAN 0008                         
10   enable  default       enable  disable    VLAN 0010                         
20   enable  default       enable  disable    VLAN 0020                         
100  enable  default       enable  disable    VLAN 0100                         
200  enable  default       enable  disable    VLAN 0200  
```

## 4. 只显示某一个 VLAN 的信息
### 命令：显示特定 VLAN
```bash
display vlan 1
```
**示例输出：**
```
<ZDNS-ShenZhen-swich01>display vlan 1
--------------------------------------------------------------------------------
U: Up;         D: Down;         TG: Tagged;         UT: Untagged;
MP: Vlan-mapping;               ST: Vlan-stacking;
#: ProtocolTransparent-vlan;    *: Management-vlan;
--------------------------------------------------------------------------------

VID  Type    Ports                                                          
--------------------------------------------------------------------------------
1    common  UT:GE0/0/8(D)      GE0/0/13(D)     GE0/0/25(D)     GE0/0/26(D)     
                GE0/0/27(D)     GE0/0/28(D)                                     

VID  Status  Property      MAC-LRN Statistics Description      
--------------------------------------------------------------------------------
1    enable  default       enable  disable    VLAN 0001     
```

## 5. 查看所有配置的 IP 接口信息
### 命令：显示 IP 接口简要信息
```bash
display ip interface brief
```
**示例输出：**
```
<ZDNS-ShenZhen-swich01>display ip interface brief
*down: administratively down
^down: standby
(l): loopback
(s): spoofing
(E): E-Trunk down
The number of interface that is UP in Physical is 6
The number of interface that is DOWN in Physical is 2
The number of interface that is UP in Protocol is 6
The number of interface that is DOWN in Protocol is 2

Interface                         IP Address/Mask      Physical   Protocol  
NULL0                             unassigned           up         up(s)     
Vlanif1                           unassigned           down       down      
Vlanif8                           172.16.8.254/24      up         up        
Vlanif10                          172.16.10.254/24     up         up        
Vlanif20                          172.16.20.254/24     up         up        
Vlanif100                         172.16.100.254/24    up         up        
Vlanif123                         unassigned           down       down      
Vlanif200                         10.200.0.2/24        up         up       
`

## 2. 查看接口情况
### 命令：显示接口简要信息
```bash
display interface brief
```
**说明：**
- **InUti/OutUti**：输入利用率/输出利用率（input utility/output utility）。

**示例输出：**
```
Interface                   PHY   Protocol  InUti OutUti   inErrors  outErrors
GigabitEthernet0/0/1        up    up        0.08%  0.06%          0          0
GigabitEthernet0/0/2        up    up        0.01%     0%          0          0
Vlanif1                     down  down         --     --          0          0
Vlanif8                     up    up           --     --          0          0
Vlanif10                    up    up           --     --          0          0
```

**PHY（物理层状态）：**
- **up**：物理链路正常（电缆连接正常，端口启用）。
- **down**：物理链路未连接（可能是未插网线、端口被禁用或对端设备未开启）。
- 其他状态（如 *down 表示管理性关闭，#down 表示链路检测关闭等）。

**Protocol（协议层状态）：**
- **内容**：显示接口的协议状态，通常与数据链路层相关，可能的值包括：
  - **up**：协议层正常，可以传输数据。
  - **down**：协议层不可用，可能是配置问题（如 VLAN 不匹配）或物理层问题。
  - **(s)**：表示接口处于伪装（spoofing）状态，通常用于 VLAN 接口，表示没有实际物理链路但逻辑上启用。
- 协议状态反映接口是否能够正常处理数据包。如果物理层 up 但协议层 down，可能是配置错误（如 VLAN 配置错误或端口未加入正确 VLAN）。

**InUti/OutUti（输入/输出利用率）：**
- **内容**：显示接口的输入和输出流量占端口带宽的百分比。例如，GigabitEthernet0/0/1 的 InUti 是 0.08%，OutUti 是 0.06%。
- 关注利用率较高的接口（如接近或超过 50%），可能需要优化网络流量或升级带宽。
- 利用率为 0% 的接口（如 GigabitEthernet0/0/5）通常是未使用的端口，可能是正常的（未连接设备）。

**inErrors/outErrors（输入/输出错误）：**
- **内容**：显示接口接收（inErrors）和发送（outErrors）的数据包错误数。例如，GigabitEthernet0/0/3 有 7 个输入错误，其他接口均为 0。

### 查看具体接口信息：
```bash
display interface GigabitEthernet0/0/5
```

**Q：这里显示的每一个接口对应交换机的一个物理接口或者逻辑接口，这句话如何理解？**
**A：**
- **物理接口** (如 GigabitEthernet0/0/1) 通常连接设备，比如电脑、服务器、另一台交换机等。
- **逻辑接口** (如 Vlanif)：用于 VLAN 的逻辑配置，可能与 IP 地址或网关相关。

【物理接口可以配置为不同模式（如 access 或 trunk），决定它们如何处理 VLAN 数据。例如，你的 GigabitEthernet0/0/5 配置为 access 模式，属于 VLAN 200（PVID: 200）。】

**物理接口和 VLAN 的关系：** 物理接口（网口）通过配置分配到某个 VLAN。例如，GigabitEthernet0/0/5 的 PVID: 200 表示它属于 VLAN 200。同一 VLAN 的多个物理接口逻辑上“连接”在一起，数据帧可以在这些端口间直接转发。

**Vlanif 的作用：** Vlanif 是一个逻辑接口，通常用于 VLAN 间的路由（例如，VLAN 8 和 VLAN 10 之间的通信需要通过 Vlanif8 和 Vlanif10 的 IP 地址）。它不直接对应物理端口，而是基于 VLAN 的配置。[听起来像是网关]

**比喻：** 你可以把交换机想象成一个大楼，物理接口是房间的网线插口，VLAN 是把某些房间分组到同一个“网络小组”里，Vlanif 则是这个小组的“管理员”，给小组分配一个 IP 地址，用于和其他小组通信。

## 3. 显示目前所有的 VLAN
### 命令：显示 VLAN
```bash
display vlan
```

**示例输出：**
```
The total number of VLANs is: 6
--------------------------------------------------------------------------------
U: Up;         D: Down;         TG: Tagged;         UT: Untagged;
MP: Vlan-mapping;               ST: Vlan-stacking;
#: ProtocolTransparent-vlan;    *: Management-vlan;
--------------------------------------------------------------------------------

VID  Type    Ports                                                          
--------------------------------------------------------------------------------
1    common  UT:GE0/0/8(D)      GE0/0/13(D)     GE0/0/25(D)     GE0/0/26(D)     
                GE0/0/27(D)     GE0/0/28(D)                                     
8    common  TG:GE0/0/3(U)      GE0/0/4(U)                                      
10   common  UT:GE0/0/9(D)      GE0/0/15(D)     GE0/0/16(D)                     
             TG:GE0/0/3(U)      GE0/0/4(U)                                      
20   common  UT:GE0/0/14(D)                                                     
             TG:GE0/0/3(U)      GE0/0/4(U)                                      
100  common  UT:GE0/0/10(D)     GE0/0/11(D)     GE0/0/12(D)                     
             TG:GE0/0/3(U)      GE0/0/4(U)      GE0/0/8(D)                      
200  common  UT:GE0/0/1(U)      GE0/0/2(U)      GE0/0/5(D)      GE0/0/6(D)      
                GE0/0/7(D)      GE0/0/21(D)     GE0/0/22(D)     GE0/0/23(D)     
                GE0/0/24(U)                                                      

VID  Status  Property      MAC-LRN Statistics Description      
--------------------------------------------------------------------------------
1    enable  default       enable  disable    VLAN 0001                         
8    enable  default       enable  disable    VLAN 0008                         
10   enable  default       enable  disable    VLAN 0010                         
20   enable  default       enable  disable    VLAN 0020                         
100  enable  default       enable  disable    VLAN 0100                         
200  enable  default       enable  disable    VLAN 0200  
```

## 4. 只显示某一个 VLAN 的信息
### 命令：显示特定 VLAN
```bash
display vlan 1
```

**示例输出：**
```
<ZDNS-ShenZhen-swich01>display vlan 1
--------------------------------------------------------------------------------
U: Up;         D: Down;         TG: Tagged;         UT: Untagged;
MP: Vlan-mapping;               ST: Vlan-stacking;
#: ProtocolTransparent-vlan;    *: Management-vlan;
--------------------------------------------------------------------------------

VID  Type    Ports                                                          
--------------------------------------------------------------------------------
1    common  UT:GE0/0/8(D)      GE0/0/13(D)     GE0/0/25(D)     GE0/0/26(D)     
                GE0/0/27(D)     GE0/0/28(D)                                     

VID  Status  Property      MAC-LRN Statistics Description      
--------------------------------------------------------------------------------
1    enable  default       enable  disable    VLAN 0001     
```

## 5. 查看所有配置的 IP 接口信息
### 命令：显示 IP 接口简要信息
```bash
display ip interface brief
```

**示例输出：**
```
<ZDNS-ShenZhen-swich01>display ip interface brief
*down: administratively down
^down: standby
(l): loopback
(s): spoofing
(E): E-Trunk down
The number of interface that is UP in Physical is 6
The number of interface that is DOWN in Physical is 2
The number of interface that is UP in Protocol is 6
The number of interface that is DOWN in Protocol is 2

Interface                         IP Address/Mask      Physical   Protocol  
NULL0                             unassigned           up         up(s)     
Vlanif1                           unassigned           down       down      
Vlanif8                           172.16.8.254/24      up         up        
Vlanif10                          172.16.10.254/24     up         up        
Vlanif20                          172.16.20.254/24     up         up        
Vlanif100                         172.16.100.254/24    up         up        
Vlanif123                         unassigned           down       down      
Vlanif200                         10.200.0.2/24        up         up       
```

